<div align="center">

<img width="256" src="./assets/logo.png">

*Enhance the retrieval assistant with hardware documentation to retrieve hardware documentation.*

<p>

<b>Hardware RAG æ˜¯ä¸€ä¸ªä¸“ä¸ºç¡¬ä»¶æŠ€æœ¯æ–‡æ¡£è®¾è®¡çš„æœ¬åœ°è½»é‡åŒ–çŸ¥è¯†åº“é—®ç­”ç³»ç»Ÿï¼Œ<br></b>
<b> èƒ½å¤Ÿé€šè¿‡å…‹éš†ä»“åº“åˆ°æœ¬åœ°, å®ç°å°å›¢é˜Ÿçš„çŸ¥è¯†åº“æ­å»ºå’Œé—®ç­”, ä¹Ÿå¯ä»¥ç”¨äºRAGæ£€ç´¢æµç¨‹çš„å­¦ä¹  </b>

<b>åŸºäº LlamaIndex å’Œ Streamlit æ„å»º</b>

<br>

*å¦‚æœè¯¥é¡¹ç›®å¯¹ä½ æœ‰ç”¨, æ¬¢è¿starğŸŒŸ &  forkğŸ´*

<br>

</p>

</div>

---
# ğŸ± éƒ¨ç½²ç¤ºä¾‹
## ğŸ“šçŸ¥è¯†åº“ç®¡ç†
![çŸ¥è¯†åº“ç®¡ç†ç¤ºä¾‹](assets/kap_example.png)

## ğŸ¤–æ£€ç´¢èŠå¤©
![æ£€ç´¢èŠå¤©æœºå™¨äºº](assets/chat_example.png)

---
## âœ¨ æ ¸å¿ƒç‰¹æ€§

- **é«˜çº§æ··åˆæ£€ç´¢æ¶æ„** :
  - **è¯­ä¹‰æ£€ç´¢** : åŸºäº Embedding çš„å‘é‡ç›¸ä¼¼åº¦æœç´¢ã€‚
  - **å…³é”®è¯æ£€ç´¢** : åŸºäº BM25 çš„å…³é”®è¯åŒ¹é…ï¼Œå¼¥è¡¥è¯­ä¹‰ä¸¢å¤±ã€‚
  - **RRF èåˆ** : ä½¿ç”¨ Reciprocal Rank Fusion ç®—æ³•åˆå¹¶åŒè·¯æ£€ç´¢ç»“æœã€‚
  - **Reranker é‡æ’åº** : å¼•å…¥ Cross-Encoder æ¨¡å‹å¯¹ç»“æœè¿›è¡ŒäºŒæ¬¡ç²¾æ’ï¼Œå¤§å¹…æå‡å›ç­”å‡†ç¡®åº¦ã€‚

- **çŸ¥è¯†åº“ç®¡ç†** :
  - **å¤šåº“éš”ç¦»** : æ”¯æŒåˆ›å»ºå¤šä¸ªç‹¬ç«‹çš„çŸ¥è¯†åº“ï¼ˆProjectï¼‰ï¼Œä¸€é”®åˆ‡æ¢ã€‚
  - **å¢é‡æ›´æ–°** : éšæ—¶ä¸Šä¼ æ–°æ–‡æ¡£ï¼Œè‡ªåŠ¨å»ºç«‹ç´¢å¼•ï¼Œæ— éœ€é‡å»ºæ•´ä¸ªåº“ã€‚
  - **ç²¾ç»†åˆ é™¤** : æ”¯æŒåˆ é™¤çŸ¥è¯†åº“ä¸­çš„å•ä¸ªæ–‡ä»¶åŠå…¶å¯¹åº”çš„å‘é‡æ•°æ®ã€‚

- **çµæ´»çš„æ¨¡å‹æ”¯æŒ** :
  - **çº¯æœ¬åœ°æ¨¡å¼** : æ”¯æŒé€šè¿‡ Ollama è¿è¡Œ LLM å’Œ Embeddingï¼Œæ•°æ®ä¸å‡ºåŸŸã€‚
  - **æ··åˆæ¨¡å¼** : æœ¬åœ° Embedding (å…è´¹/å¿«) + äº‘ç«¯ LLM (æ™ºèƒ½/å¼º)ã€‚
  - **é«˜å¯ç”¨** : å†…ç½® API é‡è¯•ä¸é™çº§æœºåˆ¶ï¼Œåº”å¯¹ç½‘ç»œæ³¢åŠ¨å’Œé™æµã€‚

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
Hardware-RAG/
â”œâ”€â”€ assets/                  # åº”ç”¨ç¤ºä¾‹å›¾ç‰‡
â”œâ”€â”€ config/
â”‚   â””â”€â”€ settings.py          # å…¨å±€é…ç½®ä¸ç¯å¢ƒå˜é‡åŠ è½½
â”œâ”€â”€ data/                    # (è‡ªåŠ¨ç”Ÿæˆ) åŸå§‹æ–‡æ¡£å­˜å‚¨è·¯å¾„
â”œâ”€â”€ storage/                 # (è‡ªåŠ¨ç”Ÿæˆ) å‘é‡æ•°æ®åº“ä¸ç¼“å­˜
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ custom_embedding.py # è‡ªå®šä¹‰ Embedding
â”‚   â”‚   â”œâ”€â”€ custom_llm.py       # è‡ªå®šä¹‰ LLM å°è£…
â”‚   â”‚   â”œâ”€â”€ custom_rag_chat.py  # èŠå¤©æ ¸å¿ƒé€»è¾‘
â”‚   â”‚   â”œâ”€â”€ hybrid_retriever.py # æ··åˆæ£€ç´¢å®ç°
â”‚   â”‚   â”œâ”€â”€ rag_pipeline.py     # RAG ä¸šåŠ¡æµç¨‹æ§åˆ¶
â”‚   â”‚   â””â”€â”€ resource_manager.py # èµ„æºä¸è¿æ¥æ± ç®¡ç†
â”‚   â””â”€â”€ ingestion/
â”‚       â””â”€â”€ index_builder.py    # ç´¢å¼•æ„å»ºå™¨
â”‚   
â”œâ”€â”€ .env                     # ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶
â”œâ”€â”€ uv.lock                  # ä¾èµ–é”å®šæ–‡ä»¶
â”œâ”€â”€ pyproject.toml           # uv é¡¹ç›®é…ç½®æ–‡ä»¶
â”œâ”€â”€ requirements.txt         # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ streamlit_app.py        # å‰ç«¯å¯åŠ¨å…¥å£
â””â”€â”€ README.md                # è¯´æ˜æ–‡æ¡£
```

## ğŸ› ï¸ ç¯å¢ƒå‡†å¤‡

- **Python**: >= 3.10
- **Ollama** : å¦‚æœè®¡åˆ’ä½¿ç”¨æœ¬åœ°æ¨¡å‹ï¼Œè¯·å…ˆå®‰è£…å¹¶å¯åŠ¨ [Ollama](https://ollama.com/)ã€‚

---

## ğŸš€ å®‰è£…éƒ¨ç½²

æœ¬é¡¹ç›®æ”¯æŒä½¿ç”¨æ–°ä¸€ä»£åŒ…ç®¡ç†å·¥å…· **uv** è¿›è¡Œéƒ¨ç½²ï¼Œä¹Ÿæ”¯æŒä¼ ç»Ÿçš„ `requirements.txt` æ–¹å¼ã€‚

### æ–¹å¼ä¸€ï¼šä½¿ç”¨ uv (æ¨è)

[uv](https://github.com/astral-sh/uv) æ˜¯ä¸€ä¸ªæé€Ÿçš„ Python åŒ…ç®¡ç†å™¨ã€‚

### **å®‰è£… uv** (å¦‚æœå°šæœªå®‰è£…):

**MacOS / Linux:**
```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```
**Windows (PowerShell):**
```bash
powershell -c "irm https://astral.sh/uv/install.ps1 | iex"
```
### **ä¸€é”®åŒæ­¥ç¯å¢ƒ**

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚è¿™å°†è¯»å– uv.lock å¹¶è‡ªåŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒã€å®‰è£…æ‰€æœ‰ç²¾ç¡®ç‰ˆæœ¬çš„ä¾èµ–ã€‚
```bash
uv sync
```

### **å¯åŠ¨åº”ç”¨**

ä½¿ç”¨ uv run å¯åŠ¨ï¼Œå®ƒä¼šè‡ªåŠ¨åŠ è½½è™šæ‹Ÿç¯å¢ƒï¼Œæ— éœ€æ‰‹åŠ¨ activateã€‚
```bash
uv run streamlit run streamlit_app.py
```

### æ–¹å¼äºŒï¼šä½¿ç”¨ pip éƒ¨ç½² (ğŸ¢ ä¼ ç»Ÿæ–¹å¼)
å¦‚æœä½ æ— æ³•ä½¿ç”¨ uvï¼Œå¯ä»¥ä½¿ç”¨ä¼ ç»Ÿçš„ requirements.txt è¿›è¡Œéƒ¨ç½²ã€‚

### **åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ** :
```bash
# åˆ›å»ºç¯å¢ƒ
python -m venv venv

# æ¿€æ´»ç¯å¢ƒ
# Windows:
venv\Scripts\activate
# macOS/Linux:
source venv/bin/activate
```
### **å®‰è£…ä¾èµ–** :

```bash
pip install -r requirements.txt
```

### **å¯åŠ¨åº”ç”¨** :
```bash
streamlit run src/streamlit_app.py
```
## âš™ï¸ é…ç½®è¯´æ˜

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª .env æ–‡ä»¶ï¼ˆå¯å‚è€ƒ .env.exampleï¼‰ã€‚
```
# ==================== æ¨¡å¼é€‰æ‹© ====================
# ollama: å…¨æœ¬åœ°æ¨¡å¼ | custom: è°ƒç”¨ç¬¬ä¸‰æ–¹ API
PROVIDER=ollama

# ==================== æœ¬åœ°æ¨¡å¼é…ç½® (Ollama) ====================
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_LLM_MODEL=qwen2.5:32b
OLLAMA_EMBEDDING_MODEL=nomic-embed-text:latest

# ==================== äº‘ç«¯ API é…ç½® (OpenRouter/DeepSeek) ====================
# ä»…å½“ PROVIDER=custom æ—¶ç”Ÿæ•ˆ
CUSTOM_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxx
CUSTOM_BASE_URL=https://openrouter.ai/api/v1
CUSTOM_LLM_MODEL=deepseek/deepseek-chat

# [å¯é€‰] æ··åˆæ¨¡å¼å¼€å…³
# è®¾ç½®ä¸º true è¡¨ç¤ºï¼šä½¿ç”¨äº‘ç«¯ LLM å›ç­”ï¼Œä½†ä½¿ç”¨æœ¬åœ° Ollama åšå‘é‡åŒ– (çœé’±ä¸”å¿«)
USE_OLLAMA_EMBEDDING=false

# ==================== RAG æ£€ç´¢å‚æ•° ====================
CHUNK_SIZE=512
VECTOR_TOP_K=20
BM25_TOP_K=20
# æœ€ç»ˆå±•ç¤ºç»™å¤§æ¨¡å‹çš„ç‰‡æ®µæ•°
FINAL_TOP_K=5

# ==================== é‡æ’åº (Reranker) ====================
# ç±»å‹: none, local, ollama, api
RERANKER_TYPE=none
```
## â“ å¸¸è§é—®é¢˜

Q: è¿è¡Œ uv sync æ—¶æç¤º lock file is not up to date?

A: è¿™é€šå¸¸å‘ç”Ÿåœ¨æ‰‹åŠ¨ä¿®æ”¹äº† pyproject.toml åã€‚è¯·è¿è¡Œ uv lock æ›´æ–°é”å®šæ–‡ä»¶ï¼Œç„¶åå†è¿è¡Œ uv syncã€‚

Q: å¯åŠ¨æ—¶æç¤º ModuleNotFoundError?

A: å¦‚æœä½¿ç”¨ uvï¼Œå¿…é¡»ä½¿ç”¨ uv run ... å¯åŠ¨å‘½ä»¤ï¼Œæˆ–è€…æ‰‹åŠ¨ source .venv/bin/activate åå†è¿è¡Œã€‚

Q: ä¸Šä¼ æ–‡ä»¶åæœç´¢ä¸åˆ°å†…å®¹ï¼Ÿ

A:

1. æ£€æŸ¥æ§åˆ¶å°æ—¥å¿—ï¼Œç¡®è®¤æ–‡ä»¶æ˜¯å¦ç´¢å¼•æˆåŠŸã€‚

2. ç¡®ä¿ .env ä¸­çš„ Embedding æ¨¡å‹é…ç½®æ­£ç¡®ã€‚

3. å¦‚æœæ˜¯ä¸­æ–‡æ–‡æ¡£ï¼ŒBM25 ä¾èµ– Jieba åˆ†è¯ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å¤„ç†ï¼Œä½†è¯·ç¡®ä¿æ–‡æ¡£ç¼–ç ä¸º UTF-8ã€‚

## ğŸ“œ License
MIT License